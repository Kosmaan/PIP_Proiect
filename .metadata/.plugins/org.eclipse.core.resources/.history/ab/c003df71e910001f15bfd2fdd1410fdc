package ro.tuiasi.ac.Proiect_PIP;

import org.apache.poi.xwpf.usermodel.XWPFDocument;
import org.apache.poi.xwpf.usermodel.XWPFParagraph;
import org.apache.poi.xwpf.usermodel.XWPFRun;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.util.List;

import org.apache.poi.xwpf.usermodel.ParagraphAlignment;

public class Scriere {
	private XWPFDocument replaceText(XWPFDocument doc, String originalText, String updatedText) {
		replaceTextInParagraphs()
	}
	
	private void replaceTextInParagraphs(List<XWPFParagraph> paragraphs, String originalText, String updatedText) {
	    paragraphs.forEach(paragraph -> replaceTextInParagraph(paragraph, originalText, updatedText));
	}
	
	private void replaceTextInParagraph(XWPFParagraph paragraph, String originalText, String updatedText) {
	    List<XWPFRun> runs = paragraph.getRuns();
	    for (XWPFRun run : runs) {
	        String text = run.getText(0);
	        if (text != null && text.contains(originalText)) {
	            String updatedRunText = text.replace(originalText, updatedText);
	            run.setText(updatedRunText, 0);
	        }
	    }
	}
	
	void replaceText() {
		String filePath = getClass().getClassLoader().getResource("Document.doc").getPath();
		try(InputStream inputStream = new FileInputStream(filePath)) {
			XWPFDocument doc = new XWPFDocument(inputStream);
			doc = replaceText(doc, "Carlos-Mihai Pascal", "Ticlosul");
			saveFile(filePath, doc);
			doc.close();
		
		} catch(Exception e) {
			e.printStackTrace();
		}
	}
}
